<div class="ai-assistant-content">
    <div class="form-group">
        <label style="font-weight:bold; display:block; margin-bottom:8px; text-align:center;">{{localize
            "AIASSISTANT.UI.ModeLabel"}}</label>
        <div class="gemini-nav-container">
            {{#each modes}}
            <label class="gemini-pill {{#if this.isActive}}active{{/if}}" data-action="selectMode"
                data-mode="{{this.id}}">
                <input type="radio" name="mode" value="{{this.id}}" {{checked this.isActive}} style="display:none">
                <i class="{{this.icon}}"></i> <span>{{this.label}}</span>
            </label>
            {{/each}}
        </div>
    </div>

    {{#if showPageSelection}}
    <div id="page-selection-wrapper"
        style="margin-bottom:10px; background:var(--ai-input-bg); border:1px solid var(--ai-input-border); border-radius:6px; padding:5px;">
        <div id="page-list-header" data-action="togglePageList"
            style="cursor:pointer; display:flex; justify-content:space-between; align-items:center; padding:4px;">
            <label style="font-weight:bold; font-size:0.9em; cursor:pointer;">{{localize "AIASSISTANT.UI.SelectPages"}}
                <i class="fas fa-chevron-down" style="font-size:0.8em; margin-left:5px;"></i></label>
            <div style="font-size:0.8em;">
                <a data-action="selectAllPages" style="margin-right:5px; cursor:pointer;">{{localize
                    "AIASSISTANT.UI.All" "Alle"}}</a> /
                <a data-action="selectNonePages" style="margin-left:5px; cursor:pointer;">{{localize
                    "AIASSISTANT.UI.None" "Keine"}}</a>
            </div>
        </div>

        <div id="page-list-content"
            style="{{#unless expandPages}}display:none;{{/unless}} margin-top:5px; padding-top:5px; border-top:1px solid var(--ai-input-border); max-height:150px; overflow-y:auto;">
            {{#each pages}}
            <div style="display:flex; align-items:center; margin-bottom:4px; font-size:0.9em;">
                <input type="checkbox" class="page-selector" name="selectedPages" value="{{this.id}}"
                    style="margin-right:8px;">
                <span style="white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"
                    title="{{this.name}}">{{this.name}}</span>
            </div>
            {{/each}}
        </div>
    </div>
    {{/if}}

    <div class="form-group" id="prompt-section" style="display: flex; flex-direction: column; gap: 6px;">
        <label style="font-weight: bold; font-size: 1.0em; text-align: center;">{{localize "AIASSISTANT.UI.PromptLabel"
            systemName=systemName}}</label>
        <!-- Note: We bind value to allow re-render persistence -->
        <textarea name="prompt" style="width:100%; height: 85px; padding: 8px; border-radius: 6px;"
            placeholder="{{localize 'AIASSISTANT.UI.PromptPlaceholder'}}">{{promptValue}}</textarea>

        <div class="gemini-checkbox-container">
            <input type="checkbox" id="send-full" name="sendFull" {{checked sendFull}}>
            <label for="send-full" style="cursor:pointer; margin:0; opacity:0.8;">{{localize
                "AIASSISTANT.UI.CheckboxFullData"}}</label>
        </div>
    </div>

    <p
        style="font-size: 0.85em; opacity:0.6; margin-top: 10px; margin-bottom: 15px; font-style: italic; text-align: center; line-height: 1.3;">
        <i class="fas fa-info-circle gemini-info-icon"></i> <span id="info-text">{{activeInfoText}}</span>
    </p>

    <div style="display:flex; justify-content:space-between; gap:10px;">
        <button type="button" class="gemini-main-button" data-action="copy">
            <i class="fas fa-copy"></i> {{localize "AIASSISTANT.UI.BtnCopy"}}
        </button>
        <button type="button" class="gemini-secondary-button" data-action="download">
            <i class="fas fa-file-download"></i> {{localize "AIASSISTANT.UI.BtnDownload"}}
        </button>
    </div>
</div>